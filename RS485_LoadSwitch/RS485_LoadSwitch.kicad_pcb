(kicad_pcb (version 20231026) (generator pcbnew)
  (general
    (thickness 1.6)
  )
  (paper "A4")
  (layers
    (0 "F.Cu" signal)
    (31 "B.Cu" signal)
    (32 "B.Adhes" user)
    (33 "F.Adhes" user)
    (34 "B.Paste" user)
    (35 "F.Paste" user)
    (36 "B.SilkS" user)
    (37 "F.SilkS" user)
    (38 "B.Mask" user)
    (39 "F.Mask" user)
    (44 "Edge.Cuts" user)
    (45 "Margin" user)
  )
  (setup
    (pad_to_mask_clearance 0)
    (pcbplotparams
      (layerselection 0x00010_80000001)
      (usegerberextensions true)
      (subtractmaskfromsilk true)
      (outputformat 1)
      (mirror false)
      (usegerberattributes true)
      (usegerberadvancedattributes true)
      (creategerberjobfile true)
    )
  )

  (gr_rect (start 0 0) (end 100 80) (layer "Edge.Cuts") (width 0.1))

  (net 0 "")
  (net 1 "GND")
  (net 2 "+12V_IN")
  (net 3 "+12V_RAIL")
  (net 4 "+5V")
  (net 5 "+3V3")
  (net 6 "RS485_A")
  (net 7 "RS485_B")
  (net 8 "UART_TX")
  (net 9 "UART_RX")
  (net 10 "UART_DE")
  (net 11 "PWM1")
  (net 12 "PWM2")
  (net 13 "PWM3")
  (net 14 "PWM4")
  (net 15 "OUT1")
  (net 16 "OUT2")
  (net 17 "OUT3")
  (net 18 "OUT4")
  (net 19 "ADC_SNS1")
  (net 20 "ADC_SNS2")
  (net 21 "ADC_SNS3")
  (net 22 "ADC_SNS4")

  (net_class "SIGNAL" (description "Logic signals")
    (clearance 0.2) (trace_width 0.25) (via_dia 0.8) (via_drill 0.4)
    (add_net "+3V3")
    (add_net "UART_TX")(add_net "UART_RX")(add_net "UART_DE")
    (add_net "PWM1")(add_net "PWM2")(add_net "PWM3")(add_net "PWM4")
    (add_net "ADC_SNS1")(add_net "ADC_SNS2")(add_net "ADC_SNS3")(add_net "ADC_SNS4")
  )
  (net_class "POWER" (description "Power rails")
    (clearance 0.25) (trace_width 1.0) (via_dia 1.2) (via_drill 0.6)
    (add_net "+12V_IN")(add_net "+12V_RAIL")(add_net "+5V")
  )
  (net_class "GND" (description "Ground") (clearance 0.25) (trace_width 1.0) (via_dia 1.2) (via_drill 0.6)
    (add_net "GND")
  )
  (net_class "LOAD" (description "High current loads")
    (clearance 0.4) (trace_width 3.0) (via_dia 1.6) (via_drill 0.8)
    (add_net "OUT1")(add_net "OUT2")(add_net "OUT3")(add_net "OUT4")
  )
  (net_class "RS485" (description "Differential pair")
    (clearance 0.2) (trace_width 0.3) (via_dia 0.8) (via_drill 0.4)
    (add_net "RS485_A")(add_net "RS485_B")
  )

  (zone (net 1) (net_name "GND") (layer "B.Cu") (hatch edge 0.5) (priority 1)
    (connect_pads (clearance 0.3)) (min_thickness 0.25)
    (polygon (pts (xy 0 0) (xy 100 0) (xy 100 80) (xy 0 80))))
  (zone (net 3) (net_name "+12V_RAIL") (layer "F.Cu") (hatch edge 0.5) (priority 2)
    (connect_pads (clearance 0.4)) (min_thickness 0.3)
    (polygon (pts (xy 60 0) (xy 100 0) (xy 100 80) (xy 60 80))))

  (footprint "Connector_JST:JST_XH_B3B-XH-A_1x03_P2.50mm_Vertical" (layer "F.Cu") (at 5 10)
    (attr through_hole)
    (fp_text reference "J1" (at 0 -3))
    (fp_text value "PWR_IN")
    (pad "1" thru_hole circle (at 0 0) (size 2.2 2.2) (drill 1.2) (layers *.Cu *.Mask) (net 2 "+12V_IN"))
    (pad "2" thru_hole circle (at 2.5 0) (size 2.2 2.2) (drill 1.2) (layers *.Cu *.Mask) (net 1 "GND"))
    (pad "3" thru_hole circle (at 5.0 0) (size 2.2 2.2) (drill 1.2) (layers *.Cu *.Mask) (net 1 "GND"))
  )

  (footprint "Package_TO_SOT_THT:TO-220-3_Vertical" (layer "F.Cu") (at 20 15)
    (attr through_hole)
    (fp_text reference "QRP")(fp_text value "IRF4905")
    (pad "1" thru_hole rect (at 0 0) (size 1.7 2.0) (drill 1.0) (layers *.Cu *.Mask) (net 3 "+12V_RAIL"))
    (pad "2" thru_hole oval (at 2.54 0) (size 1.7 2.0) (drill 1.0) (layers *.Cu *.Mask) (net 2 "+12V_IN"))
    (pad "3" thru_hole oval (at 5.08 0) (size 1.7 2.0) (drill 1.0) (layers *.Cu *.Mask) (net 3 "+12V_RAIL"))
  )

  (footprint "Diode_SMD:D_SMB" (layer "F.Cu") (at 15 25)
    (fp_text reference "D_IN")(fp_text value "SMBJ24A")
    (pad "1" smd rect (at -2 0) (size 2.5 2.0) (layers "F.Cu" "F.Mask") (net 3 "+12V_RAIL"))
    (pad "2" smd rect (at 2 0) (size 2.5 2.0) (layers "F.Cu" "F.Mask") (net 1 "GND"))
  )

  (footprint "Package_TO_SOT_SMD:TO-263-5_TabPin3" (layer "F.Cu") (at 20 40)
    (fp_text reference "U1")(fp_text value "LM2596S-5.0")
    (pad "1" smd rect (at -6.8 -2.54) (size 3 1.8) (layers "F.Cu" "F.Mask") (net 3 "+12V_RAIL"))
    (pad "2" smd rect (at -6.8 0) (size 3 1.8) (layers "F.Cu" "F.Mask") (net 1 "GND"))
    (pad "3" smd rect (at -6.8 2.54) (size 3 1.8) (layers "F.Cu" "F.Mask") (net 4 "+5V"))
    (pad "4" smd rect (at 6.8 0) (size 7 7) (layers "F.Cu" "F.Mask") (net 4 "+5V"))
    (pad "5" smd rect (at -6.8 5.08) (size 3 1.8) (layers "F.Cu" "F.Mask") (net 1 "GND"))
  )
  (footprint "Inductor_SMD:L_8x8mm" (layer "F.Cu") (at 40 40)
    (fp_text reference "L1")(fp_text value "33uH")
    (pad "1" smd rect (at -3 0) (size 3 3) (layers "F.Cu" "F.Mask") (net 4 "+5V"))
    (pad "2" smd rect (at 3 0) (size 3 3) (layers "F.Cu" "F.Mask") (net 4 "+5V"))
  )
  (footprint "Diode_SMD:D_SMC" (layer "F.Cu") (at 33 46)
    (fp_text reference "D_BK")(fp_text value "MBR360")
    (pad "1" smd rect (at -3 0) (size 3 2) (layers "F.Cu" "F.Mask") (net 4 "+5V"))
    (pad "2" smd rect (at 3 0) (size 3 2) (layers "F.Cu" "F.Mask") (net 1 "GND"))
  )
  (footprint "Capacitor_SMD:CP_Elec_6.3x7.7" (layer "F.Cu") (at 48 36)
    (fp_text reference "COUT1")(fp_text value "330uF/10V")
    (pad "1" smd rect (at -2.5 0) (size 2.5 3.5) (layers "F.Cu" "F.Mask") (net 4 "+5V"))
    (pad "2" smd rect (at 2.5 0) (size 2.5 3.5) (layers "F.Cu" "F.Mask") (net 1 "GND"))
  )
  (footprint "Capacitor_SMD:C_1206_3216Metric" (layer "F.Cu") (at 52 36)
    (fp_text reference "COUT2")(fp_text value "22uF")
    (pad "1" smd rect (at -1.5 0) (size 1.6 1.2) (layers "F.Cu" "F.Mask") (net 4 "+5V"))
    (pad "2" smd rect (at 1.5 0) (size 1.6 1.2) (layers "F.Cu" "F.Mask") (net 1 "GND"))
  )

  (footprint "Package_TO_SOT_SMD:SOT-23" (layer "F.Cu") (at 55 25)
    (fp_text reference "U2")(fp_text value "MCP1700-3302")
    (pad "1" smd rect (at -1 0.95) (size 1 0.9) (layers "F.Cu" "F.Mask") (net 4 "+5V"))
    (pad "2" smd rect (at -1 -0.95) (size 1 0.9) (layers "F.Cu" "F.Mask") (net 1 "GND"))
    (pad "3" smd rect (at 1 0) (size 1 0.9) (layers "F.Cu" "F.Mask") (net 5 "+3V3"))
  )

  (footprint "Package_SO:SOIC-8_3.9x4.9mm_P1.27mm" (layer "F.Cu") (at 15 70)
    (fp_text reference "U3")(fp_text value "THVD1450")
    (pad "1" smd rect (at -1.905 -2.54) (size 1.5 0.6) (layers "F.Cu" "F.Mask") (net 9 "UART_RX"))
    (pad "2" smd rect (at -0.635 -2.54) (size 1.5 0.6) (layers "F.Cu" "F.Mask") (net 1 "GND"))
    (pad "3" smd rect (at 0.635 -2.54) (size 1.5 0.6) (layers "F.Cu" "F.Mask") (net 8 "UART_TX"))
    (pad "4" smd rect (at 1.905 -2.54) (size 1.5 0.6) (layers "F.Cu" "F.Mask") (net 10 "UART_DE"))
    (pad "5" smd rect (at 1.905 2.54) (size 1.5 0.6) (layers "F.Cu" "F.Mask") (net 6 "RS485_A"))
    (pad "6" smd rect (at 0.635 2.54) (size 1.5 0.6) (layers "F.Cu" "F.Mask") (net 7 "RS485_B"))
    (pad "7" smd rect (at -0.635 2.54) (size 1.5 0.6) (layers "F.Cu" "F.Mask") (net 4 "+5V"))
    (pad "8" smd rect (at -1.905 2.54) (size 1.5 0.6) (layers "F.Cu" "F.Mask") (net 4 "+5V"))
  )
  (footprint "Connector_JST:JST_XH_B3B-XH-A_1x03_P2.50mm_Vertical" (layer "F.Cu") (at 5 60)
    (fp_text reference "J2")(fp_text value "RS485")
    (pad "1" thru_hole circle (at 0 0) (size 2.2 2.2) (drill 1.2) (layers *.Cu *.Mask) (net 6 "RS485_A"))
    (pad "2" thru_hole circle (at 2.5 0) (size 2.2 2.2) (drill 1.2) (layers *.Cu *.Mask) (net 7 "RS485_B"))
    (pad "3" thru_hole circle (at 5.0 0) (size 2.2 2.2) (drill 1.2) (layers *.Cu *.Mask) (net 1 "GND"))
  )
  (footprint "Package_TO_SOT_SMD:SOT-23-6" (layer "F.Cu") (at 10 55)
    (fp_text reference "D_RS485")(fp_text value "SM712")
    (pad "1" smd rect (at -1 0.95) (size 0.6 0.5) (layers "F.Cu" "F.Mask") (net 6 "RS485_A"))
    (pad "2" smd rect (at -1 0) (size 0.6 0.5) (layers "F.Cu" "F.Mask") (net 7 "RS485_B"))
    (pad "3" smd rect (at -1 -0.95) (size 0.6 0.5) (layers "F.Cu" "F.Mask") (net 1 "GND"))
    (pad "4" smd rect (at 1 0.95) (size 0.6 0.5) (layers "F.Cu" "F.Mask") (net 1 "GND"))
    (pad "5" smd rect (at 1 0) (size 0.6 0.5) (layers "F.Cu" "F.Mask") (net 6 "RS485_A"))
    (pad "6" smd rect (at 1 -0.95) (size 0.6 0.5) (layers "F.Cu" "F.Mask") (net 7 "RS485_B"))
  )

  (footprint "Package_QFP:LQFP-48_7x7mm_P0.5mm" (layer "F.Cu") (at 35 30)
    (fp_text reference "U4")(fp_text value "STM32F103C8T6")
    (pad "1" smd rect (at -3.5 -3.5) (size 0.3 1.5) (layers "F.Cu" "F.Mask") (net 5 "+3V3"))
  )

  (footprint "Package_SO:SOIC-14_3.9x8.7mm_P1.27mm" (layer "F.Cu") (at 70 40)
    (fp_text reference "U5")(fp_text value "TC4468")
  )

  (footprint "Package_TO_SOT_THT:TO-220-3_Vertical" (layer "F.Cu") (at 85 20)
    (fp_text reference "Q1")(fp_text value "IRLZ44N")
    (pad "1" thru_hole rect (at 0 0) (size 1.7 2.0) (drill 1.0) (layers *.Cu *.Mask))
    (pad "2" thru_hole oval (at 2.54 0) (size 1.7 2.0) (drill 1.0) (layers *.Cu *.Mask) (net 15 "OUT1"))
    (pad "3" thru_hole oval (at 5.08 0) (size 1.7 2.0) (drill 1.0) (layers *.Cu *.Mask) (net 1 "GND"))
  )
  (footprint "Resistor_SMD:R_2512_6332Metric" (layer "F.Cu") (at 90 28)
    (fp_text reference "R_SHUNT1")(fp_text value "0.05R")
    (pad "1" smd rect (at -2 0) (size 2.6 3.2) (layers "F.Cu" "F.Mask") (net 1 "GND"))
    (pad "2" smd rect (at 2 0) (size 2.6 3.2) (layers "F.Cu" "F.Mask") (net 1 "GND"))
  )
  (footprint "Diode_SMD:D_SMA" (layer "F.Cu") (at 88 15)
    (fp_text reference "D_FREE1")(fp_text value "STPS3L60")
    (pad "1" smd rect (at -2 0) (size 2.6 1.6) (layers "F.Cu" "F.Mask") (net 15 "OUT1"))
    (pad "2" smd rect (at 2 0) (size 2.6 1.6) (layers "F.Cu" "F.Mask") (net 3 "+12V_RAIL"))
  )
  (footprint "Diode_SMD:D_SMB" (layer "F.Cu") (at 92 15)
    (fp_text reference "D_TVS1")(fp_text value "SMBJ33A")
    (pad "1" smd rect (at -2 0) (size 2.5 2.0) (layers "F.Cu" "F.Mask") (net 15 "OUT1"))
    (pad "2" smd rect (at 2 0) (size 2.5 2.0) (layers "F.Cu" "F.Mask") (net 3 "+12V_RAIL"))
  )
  (footprint "Connector_JST:JST_VH_B2P-VH_1x02_P3.96mm_Vertical" (layer "F.Cu") (at 95 10)
    (fp_text reference "J_OUT1")(fp_text value "+12V/OUT1")
    (pad "1" thru_hole circle (at 0 0) (size 2.6 2.6) (drill 1.3) (layers *.Cu *.Mask) (net 3 "+12V_RAIL"))
    (pad "2" thru_hole circle (at 3.96 0) (size 2.6 2.6) (drill 1.3) (layers *.Cu *.Mask) (net 15 "OUT1"))
  )

  (via (at 50 50) (size 1.2) (drill 0.6) (layers "F.Cu" "B.Cu") (net 1))
  (via (at 60 50) (size 1.2) (drill 0.6) (layers "F.Cu" "B.Cu") (net 1))

  (segment (start 5 10) (end 20 15) (width 1.0) (layer "F.Cu") (net 2))
  (segment (start 25 15) (end 60 15) (width 2.5) (layer "F.Cu") (net 3))
  (segment (start 95 10) (end 95 15) (width 3.0) (layer "F.Cu") (net 3))

  (gr_text "RS-485 4-CH 12V Load Ctrl / PWM" (at 50 78) (layer "F.SilkS") (size 1.5 1.5) (thickness 0.25))
)
