(kicad_sch (version 20211014) (generator eeschema)
  (paper "A4")
  (title_block
    (title "RS-485 4-Channel 12V Load Controller")
    (rev "A1")
    (company "")
    (comment 1 "MCU: STM32F103C8T6; RS-485: THVD1450; Driver: TC4468; Sense: INA180")
  )

  (lib_symbols)

  (sheet_instances
    (path "/" (page 1))
    (path "/10_LoadChannel" (page 2))
  )

  (junction (at 0 0))
  (text "Notes: See README.md for jumper defaults and bring-up." (at 50 10 0))

  (symbol (lib_id Connector:Conn_01x02) (at 30 30 0)
    (property "Reference" "J_PWR" (at 30 25 0)(effects (font (size 1.27 1.27))))
    (property "Value" "+12V IN" (at 30 35 0))
    (pin "1" (uuid 1))
    (pin "2" (uuid 2))
  )
  (symbol (lib_id Device:Q_PMOS_GDS) (at 45 30 0)
    (property "Reference" "Q_RVB" (at 45 25 0))
    (property "Value" "IRF4905")
  )
  (symbol (lib_id Diode:SMBJ) (at 38 30 0)
    (property "Reference" "D_IN_TVS" (at 38 25 0))
    (property "Value" "SMBJ24A")
  )

  (symbol (lib_id Regulator_Switching:LM2596S-5) (at 60 30 0)
    (property "Reference" "U_Buck" (at 60 25 0))
    (property "Value" "LM2596S-5.0")
  )
  (symbol (lib_id Regulator_Linear:MCP1700-3302E) (at 80 30 0)
    (property "Reference" "U_LDO" (at 80 25 0))
    (property "Value" "MCP1700-3.3")
  )

  (symbol (lib_id MCU_ST_STM32:STM32F103C8Tx) (at 60 80 0)
    (property "Reference" "U_MCU" (at 60 70 0))
    (property "Value" "STM32F103C8T6")
  )
  (symbol (lib_id Connector:Conn_02x05_Odd_Even) (at 35 80 0)
    (property "Reference" "J_SWD" (at 35 75 0))
    (property "Value" "SWD_2x5_50mil")
  )
  (symbol (lib_id Device:Crystal) (at 52 92 0)
    (property "Reference" "Y1" (at 52 90 0))
    (property "Value" "8MHz")
  )

  (symbol (lib_id Interface_UART:THVD1450) (at 30 60 0)
    (property "Reference" "U_RS485" (at 30 55 0))
    (property "Value" "THVD1450")
  )
  (symbol (lib_id Connector:Conn_01x03) (at 20 60 0)
    (property "Reference" "J485" (at 20 55 0))
    (property "Value" "RS-485 A/B/GND")
  )
  (symbol (lib_id Diode:SM712) (at 18 60 0)
    (property "Reference" "D_RS485" (at 18 55 0))
    (property "Value" "SM712")
  )
  (symbol (lib_id Device:R) (at 25 64 0) (property "Reference" "R_TERM" (at 25 63 0))(property "Value" "120R"))
  (symbol (lib_id Device:R) (at 25 66 0) (property "Reference" "R_BIAS_UP" (at 25 65 0))(property "Value" "680R"))
  (symbol (lib_id Device:R) (at 25 58 0) (property "Reference" "R_BIAS_DN" (at 25 57 0))(property "Value" "680R"))

  (symbol (lib_id Device:DIP_Switch_x04) (at 85 80 0)
    (property "Reference" "SW_ADDR" (at 85 75 0))
    (property "Value" "4-bit DIP Addr")
  )

  (sheet (at 120 40 0)
    (property "Sheet name" "CH1" (at 120 35 0))
    (property "Sheet file" "10_LoadChannel.kicad_sch")
    (property "FPN" "1")
    (pin "PWM_IN" input)
    (pin "SHUNT_OUT" output)
    (pin "+12_SYS" input)
    (pin "OUT" output)
  )
  (sheet (at 120 60 0)
    (property "Sheet name" "CH2" (at 120 55 0))
    (property "Sheet file" "10_LoadChannel.kicad_sch")
    (property "FPN" "2")
    (pin "PWM_IN" input)
    (pin "SHUNT_OUT" output)
    (pin "+12_SYS" input)
    (pin "OUT" output)
  )
  (sheet (at 120 80 0)
    (property "Sheet name" "CH3" (at 120 75 0))
    (property "Sheet file" "10_LoadChannel.kicad_sch")
    (property "FPN" "3")
    (pin "PWM_IN" input)
    (pin "SHUNT_OUT" output)
    (pin "+12_SYS" input)
    (pin "OUT" output)
  )
  (sheet (at 120 100 0)
    (property "Sheet name" "CH4" (at 120 95 0))
    (property "Sheet file" "10_LoadChannel.kicad_sch")
    (property "FPN" "4")
    (pin "PWM_IN" input)
    (pin "SHUNT_OUT" output)
    (pin "+12_SYS" input)
    (pin "OUT" output)
  )

  (wire (pts (xy 30 30) (xy 45 30)))  ; J_PWR to reverse PFET
  (wire (pts (xy 45 30) (xy 60 30)))  ; reverse PFET to buck
  (wire (pts (xy 60 30) (xy 80 30)))  ; buck to LDO
)
